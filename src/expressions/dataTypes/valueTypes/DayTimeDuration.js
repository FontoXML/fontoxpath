"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const AbstractDuration_1 = require("./AbstractDuration");
/**
 * @extends {AbstractDuration}
 */
class DayTimeDuration extends AbstractDuration_1.default {
    constructor(seconds) {
        super();
        if (seconds > Number.MAX_SAFE_INTEGER || seconds < Number.MIN_SAFE_INTEGER) {
            throw new Error('FODT0002: Number of seconds given to construct DayTimeDuration overflows MAX_SAFE_INTEGER or MIN_SAFE_INTEGER');
        }
        this._seconds = seconds;
    }
    getRawSeconds() {
        return this._seconds;
    }
    getDays() {
        return Math.trunc(this._seconds / 86400);
    }
    getHours() {
        return Math.trunc((this._seconds % 86400) / 3600);
    }
    getMinutes() {
        return Math.trunc((this._seconds % 3600) / 60);
    }
    getSeconds() {
        const result = this._seconds % 60;
        return Object.is(-0, result) ? 0 : result;
    }
    isPositive() {
        return Object.is(-0, this._seconds) ? false : this._seconds >= 0;
    }
    toStringWithoutP() {
        const days = Math.abs(this.getDays());
        const hours = Math.abs(this.getHours());
        const minutes = Math.abs(this.getMinutes());
        const seconds = Math.abs(this.getSeconds());
        const stringValue = `${days ? `${days}DT` : 'T'}` +
            `${hours ? `${hours}H` : ''}` +
            `${minutes ? `${minutes}M` : ''}` +
            `${seconds ? `${seconds}S` : ''}`;
        return stringValue === 'T' ? 'T0S' : stringValue;
    }
    toString() {
        return (this.isPositive() ? 'P' : '-P') + this.toStringWithoutP();
    }
}
/**
 * @static
 * @param   {number}  days
 * @param   {number}  hours
 * @param   {number}  minutes
 * @param   {number}  seconds
 * @param   {number}  secondFraction
 * @param   {boolean} isPositive
 * @return  {DayTimeDuration}
 */
DayTimeDuration.fromParts = function (days, hours, minutes, seconds, secondFraction, isPositive) {
    const totalSeconds = days * 86400 + hours * 3600 + minutes * 60 + seconds + secondFraction;
    return new DayTimeDuration(isPositive || totalSeconds === 0 ? totalSeconds : -totalSeconds);
};
/**
 * @static
 * @param   {string}  string
 * @return  {?DayTimeDuration}
 */
DayTimeDuration.fromString = function (string) {
    const regex = /^(-)?P(\d+Y)?(\d+M)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/;
    const match = regex.exec(string);
    if (!match) {
        return null;
    }
    const isPositive = !match[1];
    const days = match[4] ? parseInt(match[4], 10) : 0;
    const hours = match[5] ? parseInt(match[5], 10) : 0;
    const minutes = match[6] ? parseInt(match[6], 10) : 0;
    const seconds = match[7] ? parseInt(match[7], 10) : 0;
    const secondFraction = match[8] ? parseFloat(match[8]) : 0;
    return DayTimeDuration.fromParts(days, hours, minutes, seconds, secondFraction, isPositive);
};
/**
 * @static
 * @param   {string}  string
 * @return  {DayTimeDuration}
 */
DayTimeDuration.fromTimezoneString = function (string) {
    const regex = /^(Z)|([+-])([01]\d):([0-5]\d)$/;
    const match = regex.exec(string);
    if (match[1] === 'Z') {
        return DayTimeDuration.fromParts(0, 0, 0, 0, 0, true);
    }
    const isPositive = match[2] === '+';
    const hours = match[3] ? parseInt(match[3], 10) : 0;
    const minutes = match[4] ? parseInt(match[4], 10) : 0;
    return DayTimeDuration.fromParts(0, hours, minutes, 0, 0, isPositive);
};
/**
 * @static
 * @param   {Date}  date
 * @return  {DayTimeDuration}
 */
DayTimeDuration.fromJavascriptDateTimezone = function (date) {
    const minutes = date.getTimezoneOffset();
    const isPositive = minutes > -1;
    return DayTimeDuration.fromParts(0, 0, Math.abs(minutes), 0, 0, isPositive);
};
/**
 * @param   {DayTimeDuration}  dayTimeDuration1
 * @param   {DayTimeDuration}  dayTimeDuration2
 * @return  {boolean}
 */
function lessThan(dayTimeDuration1, dayTimeDuration2) {
    return dayTimeDuration1._seconds < dayTimeDuration2._seconds;
}
exports.lessThan = lessThan;
/**
 * @param   {DayTimeDuration}  dayTimeDuration1
 * @param   {DayTimeDuration}  dayTimeDuration2
 * @return  {boolean}
 */
function greaterThan(dayTimeDuration1, dayTimeDuration2) {
    return dayTimeDuration1._seconds > dayTimeDuration2._seconds;
}
exports.greaterThan = greaterThan;
/**
 * @param   {DayTimeDuration}  dayTimeDuration1
 * @param   {DayTimeDuration}  dayTimeDuration2
 * @return  {DayTimeDuration}
 */
function add(dayTimeDuration1, dayTimeDuration2) {
    return new DayTimeDuration(dayTimeDuration1._seconds + dayTimeDuration2._seconds);
}
exports.add = add;
/**
 * @param   {DayTimeDuration}  dayTimeDuration1
 * @param   {DayTimeDuration}  dayTimeDuration2
 * @return  {DayTimeDuration}
 */
function subtract(dayTimeDuration1, dayTimeDuration2) {
    return new DayTimeDuration(dayTimeDuration1._seconds - dayTimeDuration2._seconds);
}
exports.subtract = subtract;
/**
 * @param   {DayTimeDuration}  dayTimeDuration
 * @param   {number}           double
 * @return  {DayTimeDuration}
 */
function multiply(dayTimeDuration, double) {
    if (isNaN(double)) {
        throw new Error('FOCA0005: Cannot multiply xs:dayTimeDuration by NaN');
    }
    const result = dayTimeDuration._seconds * double;
    if (result > Number.MAX_SAFE_INTEGER || !Number.isFinite(result)) {
        throw new Error('FODT0002: Value overflow while multiplying xs:dayTimeDuration');
    }
    return new DayTimeDuration(result < Number.MIN_SAFE_INTEGER || Object.is(-0, result) ? 0 : result);
}
exports.multiply = multiply;
/**
 * @param   {DayTimeDuration}  dayTimeDuration
 * @param   {number}           double
 * @return  {DayTimeDuration}
 */
function divide(dayTimeDuration, double) {
    if (isNaN(double)) {
        throw new Error('FOCA0005: Cannot divide xs:dayTimeDuration by NaN');
    }
    const result = dayTimeDuration._seconds / double;
    if (result > Number.MAX_SAFE_INTEGER || !Number.isFinite(result)) {
        throw new Error('FODT0002: Value overflow while dividing xs:dayTimeDuration');
    }
    return new DayTimeDuration(result < Number.MIN_SAFE_INTEGER || Object.is(-0, result) ? 0 : result);
}
exports.divide = divide;
/**
 * @param   {DayTimeDuration}  dayTimeDuration1
 * @param   {DayTimeDuration}  dayTimeDuration2
 * @return  {number}
 */
function divideByDayTimeDuration(dayTimeDuration1, dayTimeDuration2) {
    if (dayTimeDuration2._seconds === 0) {
        throw new Error('FOAR0001: Division by 0');
    }
    return dayTimeDuration1._seconds / dayTimeDuration2._seconds;
}
exports.divideByDayTimeDuration = divideByDayTimeDuration;
exports.default = DayTimeDuration;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF5VGltZUR1cmF0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRGF5VGltZUR1cmF0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEseURBQWtEO0FBRWxEOztHQUVHO0FBQ0gsTUFBTSxlQUFnQixTQUFRLDBCQUFnQjtJQUU3QyxZQUFhLE9BQU87UUFDbkIsS0FBSyxFQUFFLENBQUM7UUFFUixJQUFJLE9BQU8sR0FBRyxNQUFNLENBQUMsZ0JBQWdCLElBQUksT0FBTyxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTtZQUMzRSxNQUFNLElBQUksS0FBSyxDQUFDLCtHQUErRyxDQUFDLENBQUM7U0FDakk7UUFFRCxJQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztJQUN6QixDQUFDO0lBRUQsYUFBYTtRQUNaLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQztJQUN0QixDQUFDO0lBRUQsT0FBTztRQUNOLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxDQUFDO0lBQzFDLENBQUM7SUFFRCxRQUFRO1FBQ1AsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRUQsVUFBVTtRQUNULE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVELFVBQVU7UUFDVCxNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztRQUNsQyxPQUFPLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQzNDLENBQUM7SUFFRCxV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RyxNQUFNLENBQUMsZ0JBQWdCLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQ2pFLE1BQU0sSUFBSSxLQUFLLENBQUMsNERBQTRELENBQUMsQ0FBQztLQUM5RTtJQUNELE9BQU8sSUFBSSxlQUFlLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsSUFBSSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3BHLENBQUM7QUFURCx3QkFTQztBQUVEOzs7O0dBSUc7QUFDSCxTQUFnQix1QkFBdUIsQ0FBRSxnQkFBZ0IsRUFBRSxnQkFBZ0I7SUFDMUUsSUFBSSxnQkFBZ0IsQ0FBQyxRQUFRLEtBQUssQ0FBQyxFQUFFO1FBQ3BDLE1BQU0sSUFBSSxLQUFLLENBQUMseUJBQXlCLENBQUMsQ0FBQztLQUMzQztJQUNELE9BQU8sZ0JBQWdCLENBQUMsUUFBUSxHQUFHLGdCQUFnQixDQUFDLFFBQVEsQ0FBQztBQUM5RCxDQUFDO0FBTEQsMERBS0M7QUFFRCxrQkFBZSxlQUFlLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQWJzdHJhY3REdXJhdGlvbiBmcm9tICcuL0Fic3RyYWN0RHVyYXRpb24nO1xuXG4vKipcbiAqIEBleHRlbmRzIHtBYnN0cmFjdER1cmF0aW9ufVxuICovXG5jbGFzcyBEYXlUaW1lRHVyYXRpb24gZXh0ZW5kcyBBYnN0cmFjdER1cmF0aW9uIHtcblx0X3NlY29uZHM6IG51bWJlcjtcblx0Y29uc3RydWN0b3IgKHNlY29uZHMpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0aWYgKHNlY29uZHMgPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBzZWNvbmRzIDwgTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignRk9EVDAwMDI6IE51bWJlciBvZiBzZWNvbmRzIGdpdmVuIHRvIGNvbnN0cnVjdCBEYXlUaW1lRHVyYXRpb24gb3ZlcmZsb3dzIE1BWF9TQUZFX0lOVEVHRVIgb3IgTUlOX1NBRkVfSU5URUdFUicpO1xuXHRcdH1cblxuXHRcdHRoaXMuX3NlY29uZHMgPSBzZWNvbmRzO1xuXHR9XG5cblx0Z2V0UmF3U2Vjb25kcyAoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlY29uZHM7XG5cdH1cblxuXHRnZXREYXlzICgpIHtcblx0XHRyZXR1cm4gTWF0aC50cnVuYyh0aGlzLl9zZWNvbmRzIC8gODY0MDApO1xuXHR9XG5cblx0Z2V0SG91cnMgKCkge1xuXHRcdHJldHVybiBNYXRoLnRydW5jKCh0aGlzLl9zZWNvbmRzICUgODY0MDApIC8gMzYwMCk7XG5cdH1cblxuXHRnZXRNaW51dGVzICgpIHtcblx0XHRyZXR1cm4gTWF0aC50cnVuYygodGhpcy5fc2Vjb25kcyAlIDM2MDApIC8gNjApO1xuXHR9XG5cblx0Z2V0U2Vjb25kcyAoKSB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gdGhpcy5fc2Vjb25kcyAlIDYwO1xuXHRcdHJldHVybiBPYmplY3QuaXMoLTAsIHJlc3VsdCkgPyAwIDogcmVzdWx0O1xuXHR9XG5cblx0aXNQb3NpdGl2ZSAoKSB7XG5cdFx0cmV0dXJuIE9iamVjdC5pcygtMCwgdGhpcy5fc2Vjb25kcykgPyBmYWxzZSA6IHRoaXMuX3NlY29uZHMgPj0gMDtcblx0fVxuXG5cdHRvU3RyaW5nV2l0aG91dFAgKCkge1xuXHRcdGNvbnN0IGRheXMgPSBNYXRoLmFicyh0aGlzLmdldERheXMoKSk7XG5cdFx0Y29uc3QgaG91cnMgPSBNYXRoLmFicyh0aGlzLmdldEhvdXJzKCkpO1xuXHRcdGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmFicyh0aGlzLmdldE1pbnV0ZXMoKSk7XG5cdFx0Y29uc3Qgc2Vjb25kcyA9IE1hdGguYWJzKHRoaXMuZ2V0U2Vjb25kcygpKTtcblx0XHRjb25zdCBzdHJpbmdWYWx1ZSA9IGAke2RheXMgPyBgJHtkYXlzfURUYCA6ICdUJ31gICtcblx0XHRcdGAke2hvdXJzID8gYCR7aG91cnN9SGAgOiAnJ31gICtcblx0XHRcdGAke21pbnV0ZXMgPyBgJHttaW51dGVzfU1gIDogJyd9YCArXG5cdFx0XHRgJHtzZWNvbmRzID8gYCR7c2Vjb25kc31TYCA6ICcnfWA7XG5cblx0XHRyZXR1cm4gc3RyaW5nVmFsdWUgPT09ICdUJyA/ICdUMFMnIDogc3RyaW5nVmFsdWU7XG5cdH1cblxuXHR0b1N0cmluZyAoKSB7XG5cdFx0cmV0dXJuICh0aGlzLmlzUG9zaXRpdmUoKSA/ICdQJyA6ICctUCcpICsgdGhpcy50b1N0cmluZ1dpdGhvdXRQKCk7XG5cdH1cbn1cblxuLyoqXG4gKiBAc3RhdGljXG4gKiBAcGFyYW0gICB7bnVtYmVyfSAgZGF5c1xuICogQHBhcmFtICAge251bWJlcn0gIGhvdXJzXG4gKiBAcGFyYW0gICB7bnVtYmVyfSAgbWludXRlc1xuICogQHBhcmFtICAge251bWJlcn0gIHNlY29uZHNcbiAqIEBwYXJhbSAgIHtudW1iZXJ9ICBzZWNvbmRGcmFjdGlvblxuICogQHBhcmFtICAge2Jvb2xlYW59IGlzUG9zaXRpdmVcbiAqIEByZXR1cm4gIHtEYXlUaW1lRHVyYXRpb259XG4gKi9cbkRheVRpbWVEdXJhdGlvbi5mcm9tUGFydHMgPSBmdW5jdGlvbiAoZGF5cywgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMsIHNlY29uZEZyYWN0aW9uLCBpc1Bvc2l0aXZlKSB7XG5cdGNvbnN0IHRvdGFsU2Vjb25kcyA9IGRheXMgKiA4NjQwMCArIGhvdXJzICogMzYwMCArIG1pbnV0ZXMgKiA2MCArIHNlY29uZHMgKyBzZWNvbmRGcmFjdGlvbjtcblx0cmV0dXJuIG5ldyBEYXlUaW1lRHVyYXRpb24oaXNQb3NpdGl2ZSB8fCB0b3RhbFNlY29uZHMgPT09IDAgPyB0b3RhbFNlY29uZHMgOiAtdG90YWxTZWNvbmRzKTtcbn07XG5cbi8qKlxuICogQHN0YXRpY1xuICogQHBhcmFtICAge3N0cmluZ30gIHN0cmluZ1xuICogQHJldHVybiAgez9EYXlUaW1lRHVyYXRpb259XG4gKi9cbkRheVRpbWVEdXJhdGlvbi5mcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZykge1xuXHRjb25zdCByZWdleCA9IC9eKC0pP1AoXFxkK1kpPyhcXGQrTSk/KFxcZCtEKT8oPzpUKFxcZCtIKT8oXFxkK00pPyhcXGQrKFxcLlxcZCopP1MpPyk/JC87XG5cdGNvbnN0IG1hdGNoID0gcmVnZXguZXhlYyhzdHJpbmcpO1xuXG5cdGlmICghbWF0Y2gpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGNvbnN0IGlzUG9zaXRpdmUgPSAhbWF0Y2hbMV07XG5cdGNvbnN0IGRheXMgPSBtYXRjaFs0XSA/IHBhcnNlSW50KG1hdGNoWzRdLCAxMCkgOiAwO1xuXHRjb25zdCBob3VycyA9IG1hdGNoWzVdID8gcGFyc2VJbnQobWF0Y2hbNV0sIDEwKSA6IDA7XG5cdGNvbnN0IG1pbnV0ZXMgPSBtYXRjaFs2XSA/IHBhcnNlSW50KG1hdGNoWzZdLCAxMCkgOiAwO1xuXHRjb25zdCBzZWNvbmRzID0gbWF0Y2hbN10gPyBwYXJzZUludChtYXRjaFs3XSwgMTApIDogMDtcblx0Y29uc3Qgc2Vjb25kRnJhY3Rpb24gPSBtYXRjaFs4XSA/IHBhcnNlRmxvYXQobWF0Y2hbOF0pIDogMDtcblxuXHRyZXR1cm4gRGF5VGltZUR1cmF0aW9uLmZyb21QYXJ0cyhkYXlzLCBob3VycywgbWludXRlcywgc2Vjb25kcywgc2Vjb25kRnJhY3Rpb24sIGlzUG9zaXRpdmUpO1xufTtcblxuLyoqXG4gKiBAc3RhdGljXG4gKiBAcGFyYW0gICB7c3RyaW5nfSAgc3RyaW5nXG4gKiBAcmV0dXJuICB7RGF5VGltZUR1cmF0aW9ufVxuICovXG5EYXlUaW1lRHVyYXRpb24uZnJvbVRpbWV6b25lU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZykge1xuXHRjb25zdCByZWdleCA9IC9eKFopfChbKy1dKShbMDFdXFxkKTooWzAtNV1cXGQpJC87XG5cdGNvbnN0IG1hdGNoID0gcmVnZXguZXhlYyhzdHJpbmcpO1xuXG5cdGlmIChtYXRjaFsxXSA9PT0gJ1onKSB7XG5cdFx0cmV0dXJuIERheVRpbWVEdXJhdGlvbi5mcm9tUGFydHMoMCwgMCwgMCwgMCwgMCwgdHJ1ZSk7XG5cdH1cblxuXHRjb25zdCBpc1Bvc2l0aXZlID0gbWF0Y2hbMl0gPT09ICcrJztcblx0Y29uc3QgaG91cnMgPSBtYXRjaFszXSA/IHBhcnNlSW50KG1hdGNoWzNdLCAxMCkgOiAwO1xuXHRjb25zdCBtaW51dGVzID0gbWF0Y2hbNF0gPyBwYXJzZUludChtYXRjaFs0XSwgMTApIDogMDtcblxuXHRyZXR1cm4gRGF5VGltZUR1cmF0aW9uLmZyb21QYXJ0cygwLCBob3VycywgbWludXRlcywgMCwgMCwgaXNQb3NpdGl2ZSk7XG59O1xuXG4vKipcbiAqIEBzdGF0aWNcbiAqIEBwYXJhbSAgIHtEYXRlfSAgZGF0ZVxuICogQHJldHVybiAge0RheVRpbWVEdXJhdGlvbn1cbiAqL1xuRGF5VGltZUR1cmF0aW9uLmZyb21KYXZhc2NyaXB0RGF0ZVRpbWV6b25lID0gZnVuY3Rpb24gKGRhdGUpIHtcblx0Y29uc3QgbWludXRlcyA9IGRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKTtcblx0Y29uc3QgaXNQb3NpdGl2ZSA9IG1pbnV0ZXMgPiAtMTtcblxuXHRyZXR1cm4gRGF5VGltZUR1cmF0aW9uLmZyb21QYXJ0cygwLCAwLCBNYXRoLmFicyhtaW51dGVzKSwgMCwgMCwgaXNQb3NpdGl2ZSk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSAgIHtEYXlUaW1lRHVyYXRpb259ICBkYXlUaW1lRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7RGF5VGltZUR1cmF0aW9ufSAgZGF5VGltZUR1cmF0aW9uMlxuICogQHJldHVybiAge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsZXNzVGhhbiAoZGF5VGltZUR1cmF0aW9uMSwgZGF5VGltZUR1cmF0aW9uMikge1xuXHRyZXR1cm4gZGF5VGltZUR1cmF0aW9uMS5fc2Vjb25kcyA8IGRheVRpbWVEdXJhdGlvbjIuX3NlY29uZHM7XG59XG5cbi8qKlxuICogQHBhcmFtICAge0RheVRpbWVEdXJhdGlvbn0gIGRheVRpbWVEdXJhdGlvbjFcbiAqIEBwYXJhbSAgIHtEYXlUaW1lRHVyYXRpb259ICBkYXlUaW1lRHVyYXRpb24yXG4gKiBAcmV0dXJuICB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdyZWF0ZXJUaGFuIChkYXlUaW1lRHVyYXRpb24xLCBkYXlUaW1lRHVyYXRpb24yKSB7XG5cdHJldHVybiBkYXlUaW1lRHVyYXRpb24xLl9zZWNvbmRzID4gZGF5VGltZUR1cmF0aW9uMi5fc2Vjb25kcztcbn1cblxuLyoqXG4gKiBAcGFyYW0gICB7RGF5VGltZUR1cmF0aW9ufSAgZGF5VGltZUR1cmF0aW9uMVxuICogQHBhcmFtICAge0RheVRpbWVEdXJhdGlvbn0gIGRheVRpbWVEdXJhdGlvbjJcbiAqIEByZXR1cm4gIHtEYXlUaW1lRHVyYXRpb259XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGQgKGRheVRpbWVEdXJhdGlvbjEsIGRheVRpbWVEdXJhdGlvbjIpIHtcblx0cmV0dXJuIG5ldyBEYXlUaW1lRHVyYXRpb24oZGF5VGltZUR1cmF0aW9uMS5fc2Vjb25kcyArIGRheVRpbWVEdXJhdGlvbjIuX3NlY29uZHMpO1xufVxuXG4vKipcbiAqIEBwYXJhbSAgIHtEYXlUaW1lRHVyYXRpb259ICBkYXlUaW1lRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7RGF5VGltZUR1cmF0aW9ufSAgZGF5VGltZUR1cmF0aW9uMlxuICogQHJldHVybiAge0RheVRpbWVEdXJhdGlvbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN1YnRyYWN0IChkYXlUaW1lRHVyYXRpb24xLCBkYXlUaW1lRHVyYXRpb24yKSB7XG5cdHJldHVybiBuZXcgRGF5VGltZUR1cmF0aW9uKGRheVRpbWVEdXJhdGlvbjEuX3NlY29uZHMgLSBkYXlUaW1lRHVyYXRpb24yLl9zZWNvbmRzKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gICB7RGF5VGltZUR1cmF0aW9ufSAgZGF5VGltZUR1cmF0aW9uXG4gKiBAcGFyYW0gICB7bnVtYmVyfSAgICAgICAgICAgZG91YmxlXG4gKiBAcmV0dXJuICB7RGF5VGltZUR1cmF0aW9ufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbXVsdGlwbHkgKGRheVRpbWVEdXJhdGlvbiwgZG91YmxlKSB7XG5cdGlmIChpc05hTihkb3VibGUpKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdGT0NBMDAwNTogQ2Fubm90IG11bHRpcGx5IHhzOmRheVRpbWVEdXJhdGlvbiBieSBOYU4nKTtcblx0fVxuXHRjb25zdCByZXN1bHQgPSBkYXlUaW1lRHVyYXRpb24uX3NlY29uZHMgKiBkb3VibGU7XG5cdGlmIChyZXN1bHQgPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCAhTnVtYmVyLmlzRmluaXRlKHJlc3VsdCkpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZPRFQwMDAyOiBWYWx1ZSBvdmVyZmxvdyB3aGlsZSBtdWx0aXBseWluZyB4czpkYXlUaW1lRHVyYXRpb24nKTtcblx0fVxuXHRyZXR1cm4gbmV3IERheVRpbWVEdXJhdGlvbihyZXN1bHQgPCBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUiB8fCBPYmplY3QuaXMoLTAsIHJlc3VsdCkgPyAwIDogcmVzdWx0KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gICB7RGF5VGltZUR1cmF0aW9ufSAgZGF5VGltZUR1cmF0aW9uXG4gKiBAcGFyYW0gICB7bnVtYmVyfSAgICAgICAgICAgZG91YmxlXG4gKiBAcmV0dXJuICB7RGF5VGltZUR1cmF0aW9ufVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGl2aWRlIChkYXlUaW1lRHVyYXRpb24sIGRvdWJsZSkge1xuXHRpZiAoaXNOYU4oZG91YmxlKSkge1xuXHRcdHRocm93IG5ldyBFcnJvcignRk9DQTAwMDU6IENhbm5vdCBkaXZpZGUgeHM6ZGF5VGltZUR1cmF0aW9uIGJ5IE5hTicpO1xuXHR9XG5cdGNvbnN0IHJlc3VsdCA9IGRheVRpbWVEdXJhdGlvbi5fc2Vjb25kcyAvIGRvdWJsZTtcblx0aWYgKHJlc3VsdCA+IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIHx8ICFOdW1iZXIuaXNGaW5pdGUocmVzdWx0KSkge1xuXHRcdHRocm93IG5ldyBFcnJvcignRk9EVDAwMDI6IFZhbHVlIG92ZXJmbG93IHdoaWxlIGRpdmlkaW5nIHhzOmRheVRpbWVEdXJhdGlvbicpO1xuXHR9XG5cdHJldHVybiBuZXcgRGF5VGltZUR1cmF0aW9uKHJlc3VsdCA8IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSIHx8IE9iamVjdC5pcygtMCwgcmVzdWx0KSA/IDAgOiByZXN1bHQpO1xufVxuXG4vKipcbiAqIEBwYXJhbSAgIHtEYXlUaW1lRHVyYXRpb259ICBkYXlUaW1lRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7RGF5VGltZUR1cmF0aW9ufSAgZGF5VGltZUR1cmF0aW9uMlxuICogQHJldHVybiAge251bWJlcn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpdmlkZUJ5RGF5VGltZUR1cmF0aW9uIChkYXlUaW1lRHVyYXRpb24xLCBkYXlUaW1lRHVyYXRpb24yKSB7XG5cdGlmIChkYXlUaW1lRHVyYXRpb24yLl9zZWNvbmRzID09PSAwKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdGT0FSMDAwMTogRGl2aXNpb24gYnkgMCcpO1xuXHR9XG5cdHJldHVybiBkYXlUaW1lRHVyYXRpb24xLl9zZWNvbmRzIC8gZGF5VGltZUR1cmF0aW9uMi5fc2Vjb25kcztcbn1cblxuZXhwb3J0IGRlZmF1bHQgRGF5VGltZUR1cmF0aW9uO1xuIl19