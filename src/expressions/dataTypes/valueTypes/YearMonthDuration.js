"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const AbstractDuration_1 = require("./AbstractDuration");
/**
 * @extends {AbstractDuration}
 */
class YearMonthDuration extends AbstractDuration_1.default {
    constructor(months) {
        super();
        if (months > Number.MAX_SAFE_INTEGER || months < Number.MIN_SAFE_INTEGER) {
            throw new Error('FODT0002: Number of months given to construct YearMonthDuration overflows MAX_SAFE_INTEGER or MIN_SAFE_INTEGER');
        }
        this._months = months;
    }
    getRawMonths() {
        return this._months;
    }
    getYears() {
        return Math.trunc(this._months / 12);
    }
    getMonths() {
        const result = this._months % 12;
        return result === 0 ? 0 : result;
    }
    isPositive() {
        return Object.is(-0, this._months) ? false : this._months >= 0;
    }
    toStringWithoutP() {
        const years = Math.abs(this.getYears());
        const months = Math.abs(this.getMonths());
        const stringValue = `${years ? `${years}Y` : ''}` + `${months ? `${months}M` : ''}`;
        return stringValue || '0M';
    }
    toString() {
        return (this.isPositive() ? 'P' : '-P') + this.toStringWithoutP();
    }
}
/**
 * @static
 * @param   {number}  years
 * @param   {number}  months
 * @param   {boolean} isPositive
 * @return  {YearMonthDuration}
 */
YearMonthDuration.fromParts = function (years, months, isPositive) {
    const totalMonths = years * 12 + months;
    if (totalMonths > Number.MAX_SAFE_INTEGER || !Number.isFinite(totalMonths)) {
        throw new Error('FODT0002: Value overflow while constructing xs:yearMonthDuration');
    }
    return new YearMonthDuration(isPositive || totalMonths === 0 ? totalMonths : -totalMonths);
};
/**
 * @static
 * @param   {string}  string
 * @return  {?YearMonthDuration}
 */
YearMonthDuration.fromString = function (string) {
    const regex = /^(-)?P(\d+Y)?(\d+M)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+(\.\d*)?S)?)?$/;
    const match = regex.exec(string);
    if (!match) {
        return null;
    }
    const isPositive = !match[1];
    const years = match[2] ? parseInt(match[2], 10) : 0;
    const months = match[3] ? parseInt(match[3], 10) : 0;
    return YearMonthDuration.fromParts(years, months, isPositive);
};
/**
 * @param   {YearMonthDuration}  yearMonthDuration1
 * @param   {YearMonthDuration}  yearMonthDuration2
 * @return  {boolean}
 */
function lessThan(yearMonthDuration1, yearMonthDuration2) {
    return yearMonthDuration1._months < yearMonthDuration2._months;
}
exports.lessThan = lessThan;
/**
 * @param   {YearMonthDuration}  yearMonthDuration1
 * @param   {YearMonthDuration}  yearMonthDuration2
 * @return  {boolean}
 */
function greaterThan(yearMonthDuration1, yearMonthDuration2) {
    return yearMonthDuration1._months > yearMonthDuration2._months;
}
exports.greaterThan = greaterThan;
/**
 * @param   {YearMonthDuration}  yearMonthDuration1
 * @param   {YearMonthDuration}  yearMonthDuration2
 * @return  {YearMonthDuration}
 */
function add(yearMonthDuration1, yearMonthDuration2) {
    return new YearMonthDuration(yearMonthDuration1._months + yearMonthDuration2._months);
}
exports.add = add;
/**
 * @param   {YearMonthDuration}  yearMonthDuration1
 * @param   {YearMonthDuration}  yearMonthDuration2
 * @return  {YearMonthDuration}
 */
function subtract(yearMonthDuration1, yearMonthDuration2) {
    return new YearMonthDuration(yearMonthDuration1._months - yearMonthDuration2._months);
}
exports.subtract = subtract;
/**
 * @param   {YearMonthDuration}  yearMonthDuration
 * @param   {number}             double
 * @return  {YearMonthDuration}
 */
function multiply(yearMonthDuration, double) {
    if (isNaN(double)) {
        throw new Error('FOCA0005: Cannot multiply xs:yearMonthDuration by NaN');
    }
    const result = Math.round(yearMonthDuration._months * double);
    if (result > Number.MAX_SAFE_INTEGER || !Number.isFinite(result)) {
        throw new Error('FODT0002: Value overflow while constructing xs:yearMonthDuration');
    }
    return new YearMonthDuration(result < Number.MIN_SAFE_INTEGER || result === 0 ? 0 : result);
}
exports.multiply = multiply;
/**
 * @param   {YearMonthDuration}  yearMonthDuration
 * @param   {number}             double
 * @return  {YearMonthDuration}
 */
function divide(yearMonthDuration, double) {
    if (isNaN(double)) {
        throw new Error('FOCA0005: Cannot divide xs:yearMonthDuration by NaN');
    }
    const result = Math.round(yearMonthDuration._months / double);
    if (result > Number.MAX_SAFE_INTEGER || !Number.isFinite(result)) {
        throw new Error('FODT0002: Value overflow while dividing xs:yearMonthDuration');
    }
    return new YearMonthDuration(result < Number.MIN_SAFE_INTEGER || result === 0 ? 0 : result);
}
exports.divide = divide;
/**
 * @param   {YearMonthDuration}  yearMonthDuration1
 * @param   {YearMonthDuration}  yearMonthDuration2
 * @return  {number}
 */
function divideByYearMonthDuration(yearMonthDuration1, yearMonthDuration2) {
    return yearMonthDuration1._months / yearMonthDuration2._months;
}
exports.divideByYearMonthDuration = divideByYearMonthDuration;
exports.default = YearMonthDuration;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWWVhck1vbnRoRHVyYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJZZWFyTW9udGhEdXJhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlEQUFrRDtBQUVsRDs7R0FFRztBQUNILE1BQU0saUJBQWtCLFNBQVEsMEJBQWdCO0lBSS9DLFlBQWEsTUFBTTtRQUNsQixLQUFLLEVBQUUsQ0FBQztRQUVSLElBQUksTUFBTSxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsSUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLGdCQUFnQixFQUFFO1lBQ3pFLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0hBQWdILENBQUMsQ0FBQztTQUNsSTtRQUVELElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxZQUFZO1FBQ1gsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3JCLENBQUM7SUFFRCxRQUFRO1FBQ1AsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELFNBQVM7UUFDUixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNqQyxPQUFPLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQ2xDLENBQUM7SUFFRCxVQUFVO1FBQ1QsT0FBTyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQztJQUNoRSxDQUFDO0lBRUQsZ0JBQWdCO1FBQ2YsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUN4QyxNQUFN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QUMsRUFBRTtRQUNqRSxNQUFNLElBQUksS0FBSyxDQUFDLDhEQUE4RCxDQUFDLENBQUM7S0FDaEY7SUFDRCxPQUFPLElBQUksaUJBQWlCLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsSUFBSSxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzdGLENBQUM7QUFURCx3QkFTQztBQUVEOzs7O0dBSUc7QUFDSCxTQUFnQix5QkFBeUIsQ0FBRSxrQkFBcUMsRUFBRSxrQkFBcUM7SUFDdEgsT0FBTyxrQkFBa0IsQ0FBQyxPQUFPLEdBQUcsa0JBQWtCLENBQUMsT0FBTyxDQUFDO0FBQ2hFLENBQUM7QUFGRCw4REFFQztBQUVELGtCQUFlLGlCQUFpQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFic3RyYWN0RHVyYXRpb24gZnJvbSAnLi9BYnN0cmFjdER1cmF0aW9uJztcblxuLyoqXG4gKiBAZXh0ZW5kcyB7QWJzdHJhY3REdXJhdGlvbn1cbiAqL1xuY2xhc3MgWWVhck1vbnRoRHVyYXRpb24gZXh0ZW5kcyBBYnN0cmFjdER1cmF0aW9uIHtcblx0X21vbnRoczogbnVtYmVyO1xuXHRzdGF0aWMgZnJvbVBhcnRzOiAoeWVhcnM6IGFueSwgbW9udGhzOiBhbnksIGlzUG9zaXRpdmU6IGFueSkgPT4gWWVhck1vbnRoRHVyYXRpb247XG5cdHN0YXRpYyBmcm9tU3RyaW5nOiAoc3RyaW5nOiBhbnkpID0+IFllYXJNb250aER1cmF0aW9uO1xuXHRjb25zdHJ1Y3RvciAobW9udGhzKSB7XG5cdFx0c3VwZXIoKTtcblxuXHRcdGlmIChtb250aHMgPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBtb250aHMgPCBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdGT0RUMDAwMjogTnVtYmVyIG9mIG1vbnRocyBnaXZlbiB0byBjb25zdHJ1Y3QgWWVhck1vbnRoRHVyYXRpb24gb3ZlcmZsb3dzIE1BWF9TQUZFX0lOVEVHRVIgb3IgTUlOX1NBRkVfSU5URUdFUicpO1xuXHRcdH1cblxuXHRcdHRoaXMuX21vbnRocyA9IG1vbnRocztcblx0fVxuXG5cdGdldFJhd01vbnRocyAoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX21vbnRocztcblx0fVxuXG5cdGdldFllYXJzICgpIHtcblx0XHRyZXR1cm4gTWF0aC50cnVuYyh0aGlzLl9tb250aHMgLyAxMik7XG5cdH1cblxuXHRnZXRNb250aHMgKCkge1xuXHRcdGNvbnN0IHJlc3VsdCA9IHRoaXMuX21vbnRocyAlIDEyO1xuXHRcdHJldHVybiByZXN1bHQgPT09IDAgPyAwIDogcmVzdWx0O1xuXHR9XG5cblx0aXNQb3NpdGl2ZSAoKSB7XG5cdFx0cmV0dXJuIE9iamVjdC5pcygtMCwgdGhpcy5fbW9udGhzKSA/IGZhbHNlIDogdGhpcy5fbW9udGhzID49IDA7XG5cdH1cblxuXHR0b1N0cmluZ1dpdGhvdXRQICgpIHtcblx0XHRjb25zdCB5ZWFycyA9IE1hdGguYWJzKHRoaXMuZ2V0WWVhcnMoKSk7XG5cdFx0Y29uc3QgbW9udGhzID0gTWF0aC5hYnModGhpcy5nZXRNb250aHMoKSk7XG5cdFx0Y29uc3Qgc3RyaW5nVmFsdWUgPSBgJHt5ZWFycyA/IGAke3llYXJzfVlgIDogJyd9YCArIGAke21vbnRocyA/IGAke21vbnRoc31NYCA6ICcnfWA7XG5cblx0XHRyZXR1cm4gc3RyaW5nVmFsdWUgfHwgJzBNJztcblx0fVxuXG5cdHRvU3RyaW5nICgpIHtcblx0XHRyZXR1cm4gKHRoaXMuaXNQb3NpdGl2ZSgpID8gJ1AnIDogJy1QJykgKyB0aGlzLnRvU3RyaW5nV2l0aG91dFAoKTtcblx0fVxufVxuXG4vKipcbiAqIEBzdGF0aWNcbiAqIEBwYXJhbSAgIHtudW1iZXJ9ICB5ZWFyc1xuICogQHBhcmFtICAge251bWJlcn0gIG1vbnRoc1xuICogQHBhcmFtICAge2Jvb2xlYW59IGlzUG9zaXRpdmVcbiAqIEByZXR1cm4gIHtZZWFyTW9udGhEdXJhdGlvbn1cbiAqL1xuWWVhck1vbnRoRHVyYXRpb24uZnJvbVBhcnRzID0gZnVuY3Rpb24gKHllYXJzOiBudW1iZXIsIG1vbnRoczogbnVtYmVyLCBpc1Bvc2l0aXZlOiBib29sZWFuKTogWWVhck1vbnRoRHVyYXRpb24ge1xuXHRjb25zdCB0b3RhbE1vbnRocyA9IHllYXJzICogMTIgKyBtb250aHM7XG5cdGlmICh0b3RhbE1vbnRocyA+IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIHx8ICFOdW1iZXIuaXNGaW5pdGUodG90YWxNb250aHMpKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdGT0RUMDAwMjogVmFsdWUgb3ZlcmZsb3cgd2hpbGUgY29uc3RydWN0aW5nIHhzOnllYXJNb250aER1cmF0aW9uJyk7XG5cdH1cblx0cmV0dXJuIG5ldyBZZWFyTW9udGhEdXJhdGlvbihpc1Bvc2l0aXZlIHx8IHRvdGFsTW9udGhzID09PSAwID8gdG90YWxNb250aHMgOiAtdG90YWxNb250aHMpO1xufTtcblxuLyoqXG4gKiBAc3RhdGljXG4gKiBAcGFyYW0gICB7c3RyaW5nfSAgc3RyaW5nXG4gKiBAcmV0dXJuICB7P1llYXJNb250aER1cmF0aW9ufVxuICovXG5ZZWFyTW9udGhEdXJhdGlvbi5mcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZzogc3RyaW5nKTogWWVhck1vbnRoRHVyYXRpb24gfCBudWxsIHtcblx0Y29uc3QgcmVnZXggPSAvXigtKT9QKFxcZCtZKT8oXFxkK00pPyhcXGQrRCk/KD86VChcXGQrSCk/KFxcZCtNKT8oXFxkKyhcXC5cXGQqKT9TKT8pPyQvO1xuXHRjb25zdCBtYXRjaCA9IHJlZ2V4LmV4ZWMoc3RyaW5nKTtcblxuXHRpZiAoIW1hdGNoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRjb25zdCBpc1Bvc2l0aXZlID0gIW1hdGNoWzFdO1xuXHRjb25zdCB5ZWFycyA9IG1hdGNoWzJdID8gcGFyc2VJbnQobWF0Y2hbMl0sIDEwKSA6IDA7XG5cdGNvbnN0IG1vbnRocyA9IG1hdGNoWzNdID8gcGFyc2VJbnQobWF0Y2hbM10sIDEwKSA6IDA7XG5cblx0cmV0dXJuIFllYXJNb250aER1cmF0aW9uLmZyb21QYXJ0cyh5ZWFycywgbW9udGhzLCBpc1Bvc2l0aXZlKTtcbn07XG5cbi8qKlxuICogQHBhcmFtICAge1llYXJNb250aER1cmF0aW9ufSAgeWVhck1vbnRoRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7WWVhck1vbnRoRHVyYXRpb259ICB5ZWFyTW9udGhEdXJhdGlvbjJcbiAqIEByZXR1cm4gIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGVzc1RoYW4gKHllYXJNb250aER1cmF0aW9uMTogWWVhck1vbnRoRHVyYXRpb24sIHllYXJNb250aER1cmF0aW9uMjogWWVhck1vbnRoRHVyYXRpb24pOiBib29sZWFuIHtcblx0cmV0dXJuIHllYXJNb250aER1cmF0aW9uMS5fbW9udGhzIDwgeWVhck1vbnRoRHVyYXRpb24yLl9tb250aHM7XG59XG5cbi8qKlxuICogQHBhcmFtICAge1llYXJNb250aER1cmF0aW9ufSAgeWVhck1vbnRoRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7WWVhck1vbnRoRHVyYXRpb259ICB5ZWFyTW9udGhEdXJhdGlvbjJcbiAqIEByZXR1cm4gIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ3JlYXRlclRoYW4gKHllYXJNb250aER1cmF0aW9uMTogWWVhck1vbnRoRHVyYXRpb24sIHllYXJNb250aER1cmF0aW9uMjogWWVhck1vbnRoRHVyYXRpb24pOiBib29sZWFuIHtcblx0cmV0dXJuIHllYXJNb250aER1cmF0aW9uMS5fbW9udGhzID4geWVhck1vbnRoRHVyYXRpb24yLl9tb250aHM7XG59XG5cbi8qKlxuICogQHBhcmFtICAge1llYXJNb250aER1cmF0aW9ufSAgeWVhck1vbnRoRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7WWVhck1vbnRoRHVyYXRpb259ICB5ZWFyTW9udGhEdXJhdGlvbjJcbiAqIEByZXR1cm4gIHtZZWFyTW9udGhEdXJhdGlvbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZCAoeWVhck1vbnRoRHVyYXRpb24xOiBZZWFyTW9udGhEdXJhdGlvbiwgeWVhck1vbnRoRHVyYXRpb24yOiBZZWFyTW9udGhEdXJhdGlvbik6IFllYXJNb250aER1cmF0aW9uIHtcblx0cmV0dXJuIG5ldyBZZWFyTW9udGhEdXJhdGlvbih5ZWFyTW9udGhEdXJhdGlvbjEuX21vbnRocyArIHllYXJNb250aER1cmF0aW9uMi5fbW9udGhzKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gICB7WWVhck1vbnRoRHVyYXRpb259ICB5ZWFyTW9udGhEdXJhdGlvbjFcbiAqIEBwYXJhbSAgIHtZZWFyTW9udGhEdXJhdGlvbn0gIHllYXJNb250aER1cmF0aW9uMlxuICogQHJldHVybiAge1llYXJNb250aER1cmF0aW9ufVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3VidHJhY3QgKHllYXJNb250aER1cmF0aW9uMTogWWVhck1vbnRoRHVyYXRpb24sIHllYXJNb250aER1cmF0aW9uMjogWWVhck1vbnRoRHVyYXRpb24pOiBZZWFyTW9udGhEdXJhdGlvbiB7XG5cdHJldHVybiBuZXcgWWVhck1vbnRoRHVyYXRpb24oeWVhck1vbnRoRHVyYXRpb24xLl9tb250aHMgLSB5ZWFyTW9udGhEdXJhdGlvbjIuX21vbnRocyk7XG59XG5cbi8qKlxuICogQHBhcmFtICAge1llYXJNb250aER1cmF0aW9ufSAgeWVhck1vbnRoRHVyYXRpb25cbiAqIEBwYXJhbSAgIHtudW1iZXJ9ICAgICAgICAgICAgIGRvdWJsZVxuICogQHJldHVybiAge1llYXJNb250aER1cmF0aW9ufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbXVsdGlwbHkgKHllYXJNb250aER1cmF0aW9uOiBZZWFyTW9udGhEdXJhdGlvbiwgZG91YmxlOiBudW1iZXIpOiBZZWFyTW9udGhEdXJhdGlvbiB7XG5cdGlmIChpc05hTihkb3VibGUpKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdGT0NBMDAwNTogQ2Fubm90IG11bHRpcGx5IHhzOnllYXJNb250aER1cmF0aW9uIGJ5IE5hTicpO1xuXHR9XG5cdGNvbnN0IHJlc3VsdCA9IE1hdGgucm91bmQoeWVhck1vbnRoRHVyYXRpb24uX21vbnRocyAqIGRvdWJsZSk7XG5cdGlmIChyZXN1bHQgPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCAhTnVtYmVyLmlzRmluaXRlKHJlc3VsdCkpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZPRFQwMDAyOiBWYWx1ZSBvdmVyZmxvdyB3aGlsZSBjb25zdHJ1Y3RpbmcgeHM6eWVhck1vbnRoRHVyYXRpb24nKTtcblx0fVxuXHRyZXR1cm4gbmV3IFllYXJNb250aER1cmF0aW9uKHJlc3VsdCA8IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSIHx8IHJlc3VsdCA9PT0gMCA/IDAgOiByZXN1bHQpO1xufVxuXG4vKipcbiAqIEBwYXJhbSAgIHtZZWFyTW9udGhEdXJhdGlvbn0gIHllYXJNb250aER1cmF0aW9uXG4gKiBAcGFyYW0gICB7bnVtYmVyfSAgICAgICAgICAgICBkb3VibGVcbiAqIEByZXR1cm4gIHtZZWFyTW9udGhEdXJhdGlvbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpdmlkZSAoeWVhck1vbnRoRHVyYXRpb246IFllYXJNb250aER1cmF0aW9uLCBkb3VibGU6IG51bWJlcik6IFllYXJNb250aER1cmF0aW9uIHtcblx0aWYgKGlzTmFOKGRvdWJsZSkpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZPQ0EwMDA1OiBDYW5ub3QgZGl2aWRlIHhzOnllYXJNb250aER1cmF0aW9uIGJ5IE5hTicpO1xuXHR9XG5cdGNvbnN0IHJlc3VsdCA9IE1hdGgucm91bmQoeWVhck1vbnRoRHVyYXRpb24uX21vbnRocyAvIGRvdWJsZSk7XG5cdGlmIChyZXN1bHQgPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCAhTnVtYmVyLmlzRmluaXRlKHJlc3VsdCkpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ZPRFQwMDAyOiBWYWx1ZSBvdmVyZmxvdyB3aGlsZSBkaXZpZGluZyB4czp5ZWFyTW9udGhEdXJhdGlvbicpO1xuXHR9XG5cdHJldHVybiBuZXcgWWVhck1vbnRoRHVyYXRpb24ocmVzdWx0IDwgTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVIgfHwgcmVzdWx0ID09PSAwID8gMCA6IHJlc3VsdCk7XG59XG5cbi8qKlxuICogQHBhcmFtICAge1llYXJNb250aER1cmF0aW9ufSAgeWVhck1vbnRoRHVyYXRpb24xXG4gKiBAcGFyYW0gICB7WWVhck1vbnRoRHVyYXRpb259ICB5ZWFyTW9udGhEdXJhdGlvbjJcbiAqIEByZXR1cm4gIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXZpZGVCeVllYXJNb250aER1cmF0aW9uICh5ZWFyTW9udGhEdXJhdGlvbjE6IFllYXJNb250aER1cmF0aW9uLCB5ZWFyTW9udGhEdXJhdGlvbjI6IFllYXJNb250aER1cmF0aW9uKTogbnVtYmVyIHtcblx0cmV0dXJuIHllYXJNb250aER1cmF0aW9uMS5fbW9udGhzIC8geWVhck1vbnRoRHVyYXRpb24yLl9tb250aHM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IFllYXJNb250aER1cmF0aW9uO1xuIl19