"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Expression_1 = require("../Expression");
const SequenceFactory_1 = require("../dataTypes/SequenceFactory");
class SelfAxis extends Expression_1.default {
    constructor(selector) {
        super(selector.specificity, [selector], {
            resultOrder: Expression_1.default.RESULT_ORDERINGS.SORTED,
            subtree: true,
            peer: true,
            canBeStaticallyEvaluated: false
        });
        this._selector = selector;
    }
    evaluate(dynamicContext, _executionParameters) {
        if (dynamicContext.contextItem === null) {
            throw new Error('XPDY0002: context is absent, it needs to be present to use axes.');
        }
        const isMatch = this._selector.evaluateToBoolean(dynamicContext, dynamicContext.contextItem);
        return isMatch ? SequenceFactory_1.default.singleton(dynamicContext.contextItem) : SequenceFactory_1.default.empty();
    }
    getBucket() {
        return this._selector.getBucket();
    }
}
exports.default = SelfAxis;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2VsZkF4aXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTZWxmQXhpcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDhDQUF1QztBQUN2QyxrRUFBMkQ7QUFHM0QsTUFBTSxRQUFTLFNBQVEsb0JBQVU7SUFFaEMsWUFBWSxRQUFnQztRQUMzQyxLQUFLLENBQ0osUUFBUSxDQUFDLFdBQVcsRUFDcEIsQ0FBQyxRQUFRLENBQUMsRUFDVjtZQUNDLFdBQVcsRUFBRSxvQkFBVSxDQUFDLGdCQUFnQixDQUFDLE1BQU07WUFDL0MsT0FBTyxFQUFFLElBQUk7WUFDYixJQUFJLEVBQUUsSUFBSTtZQUNWLHdCQUF3QixFQUFFLEtBQUs7U0FDL0IsQ0FBQyxDQUFDO1FBRUosSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVELFFBQVEsQ0FBRSxjQUFjLEVBQUUsb0JBQW9CO1FBQzdDLElBQUksY0FBYyxDQUFDLFdBQVcsS0FBSyxJQUFJLEVBQUU7WUFDeEMsTUFBTSxJQUFJLEtBQUssQ0FBQyxrRUFBa0UsQ0FBQyxDQUFDO1NBQ3BGO1FBRUQsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLEVBQUUsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzdGLE9BQU8sT0FBTyxDQUFDLENBQUMsQ0FBQyx5QkFBZSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLHlCQUFlLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDbEcsQ0FBQztJQUVELFNBQVM7UUFDUixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDbkMsQ0FBQztDQUNEO0FBQ0Qsa0JBQWUsUUFBUSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEV4cHJlc3Npb24gZnJvbSAnLi4vRXhwcmVzc2lvbic7XG5pbXBvcnQgU2VxdWVuY2VGYWN0b3J5IGZyb20gJy4uL2RhdGFUeXBlcy9TZXF1ZW5jZUZhY3RvcnknO1xuaW1wb3J0IFRlc3RBYnN0cmFjdEV4cHJlc3Npb24gZnJvbSAnLi4vdGVzdHMvVGVzdEFic3RyYWN0RXhwcmVzc2lvbic7XG5cbmNsYXNzIFNlbGZBeGlzIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG5cdF9zZWxlY3RvcjogVGVzdEFic3RyYWN0RXhwcmVzc2lvbjtcblx0Y29uc3RydWN0b3Ioc2VsZWN0b3I6IFRlc3RBYnN0cmFjdEV4cHJlc3Npb24pIHtcblx0XHRzdXBlcihcblx0XHRcdHNlbGVjdG9yLnNwZWNpZmljaXR5LFxuXHRcdFx0W3NlbGVjdG9yXSxcblx0XHRcdHtcblx0XHRcdFx0cmVzdWx0T3JkZXI6IEV4cHJlc3Npb24uUkVTVUxUX09SREVSSU5HUy5TT1JURUQsXG5cdFx0XHRcdHN1YnRyZWU6IHRydWUsXG5cdFx0XHRcdHBlZXI6IHRydWUsXG5cdFx0XHRcdGNhbkJlU3RhdGljYWxseUV2YWx1YXRlZDogZmFsc2Vcblx0XHRcdH0pO1xuXG5cdFx0dGhpcy5fc2VsZWN0b3IgPSBzZWxlY3Rvcjtcblx0fVxuXG5cdGV2YWx1YXRlIChkeW5hbWljQ29udGV4dCwgX2V4ZWN1dGlvblBhcmFtZXRlcnMpIHtcblx0XHRpZiAoZHluYW1pY0NvbnRleHQuY29udGV4dEl0ZW0gPT09IG51bGwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignWFBEWTAwMDI6IGNvbnRleHQgaXMgYWJzZW50LCBpdCBuZWVkcyB0byBiZSBwcmVzZW50IHRvIHVzZSBheGVzLicpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGlzTWF0Y2ggPSB0aGlzLl9zZWxlY3Rvci5ldmFsdWF0ZVRvQm9vbGVhbihkeW5hbWljQ29udGV4dCwgZHluYW1pY0NvbnRleHQuY29udGV4dEl0ZW0pO1xuXHRcdHJldHVybiBpc01hdGNoID8gU2VxdWVuY2VGYWN0b3J5LnNpbmdsZXRvbihkeW5hbWljQ29udGV4dC5jb250ZXh0SXRlbSkgOiBTZXF1ZW5jZUZhY3RvcnkuZW1wdHkoKTtcblx0fVxuXG5cdGdldEJ1Y2tldCAoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlbGVjdG9yLmdldEJ1Y2tldCgpO1xuXHR9XG59XG5leHBvcnQgZGVmYXVsdCBTZWxmQXhpcztcbiJdfQ==